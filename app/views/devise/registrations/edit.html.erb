<% activate_nav! :settings %>
<% title 'Settings' %>
<% bg_carousel %>

<%= render 'shared/nav' %>

<main class="document meta-split mw8">
  <div class="meta-split__col meta-split__col--left">
    <%= section_header 'My account', 2, class: 'mtn mbm grey-2 f3' %>
    <%= form_for resource_name, url: registration_path(resource_name), html: { method: :patch } do |f| %>

      <%= devise_error_messages! %>

      <%= f.label t('.fn'), class: 'label' %>
      <%= f.text_field :first_name, class: 'text-input', id: 'fname', required: true %>

      <%= f.label t('.email_a'), class: 'label' %>
      <%= f.email_field :email, class: 'text-input', autocomplete: 'email' %>

      <div class="flex fac mts">
        <%= f.check_box :want_newsletter, class: 'mrs' %>
        <%= f.label :want_newsletter, 'Receive the (occasional) newsletter', class: 'man' %>
      </div>

      <%= f.label :phone, 'Phone number (+ intl code)', class: 'label' %>
      <small class="f5 db grey-3">(only for SMS grocery list—kept safe, no spam)</small>
      <%= f.phone_field :phone, placeholder: '1555-555-5555', class: 'text-input' %>

      <%= section_header 'Change your password?', 3, class: 'mtm mbs grey-2 f4' %>

      <%= f.label :password, 'Current password', class: 'label' %>
      <%= f.password_field :current_password, placeholder: 'Required', class: 'text-input' %>

      <%= f.label :password, 'New password', class: 'label' %>
      <%= f.password_field :password, pattern: '.{8,}', placeholder: '8 characters recommended', class: 'text-input' %>

      <%= f.submit t('general.update'), class: 'btn bg-blue mtm' %>

    <% end %>
  </div>
  <div class="meta-split__col meta-split__col--right">
    <%= section_header 'Help', 2, class: 'mtn mbs grey-2 f3' %>
    <%= render 'shared/help', hide_footer: true %>

    <%= section_header 'Subscription', 2, class: 'mtl mbs grey-2 f3' %>
    <% if current_user.subscriber? %>
      <p>Thank you for subscribing! It helps a lot.</p>
      <%= link_to 'Manage my subscription', subscriptions_path, class: 'btn bg-green' %>
    <% else %>
      <p>
        Please consider buying a subscription—$12/year to help keep Noodles running.
      </p>
      <%= link_to 'Learn more', subscriptions_path, class: 'btn bg-green' %>
    <% end %>

    <%= section_header 'Delete your account', 2, class: 'mtl mbs grey-2 f3' %>
    <p>
      If you want to delete your account, click the button below. All your recipes, as well as shared recipes, will be erased forever.
    </p>

    <%= link_to t('.delete_my_account'),
      user_registration_path(current_user),
      method: :delete,
      class: 'btn btn-sm bg-red',
      'data-confirm': 'Are you sure you want to delete your Noodles account and your recipes?'
    %>
  </div>
</main>
