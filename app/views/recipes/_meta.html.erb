<div id="collectModal" class="modal">
  <%= modal_close %>

  <h2>Add to Collection</h2>
  <hr>
  <% @collections = current_user.collections %>
  <% if @collections.any? %>
    <% if @recipe.collections.length <= 4 %>
    <p>Tap on any of your collections below to add this recipe to them.</p>
    <% else %>
    <p>This recipe is already in <%= pluralize(@recipe.collections.reject!(&:blank?).count, 'collection') %>. To add it to additional collections, click on them in the list below.</p>
    <% end %>

    <%= form_for(@recipe) do |f| %>
      <ul class="list-reset sm-col-10 mw5 mx-auto">
        <%= collection_check_boxes(:recipe, :collections, @collections, :id, :name) do |b| %>
        <li class="border-top">
          <%= b.label(class: 'collection-list-item man pas pointer') do %>
            <% if @recipe.collections.include?(b.value.to_s) %>
            <%= b.check_box checked: 'checked', class: 'dn' %>
            <% else %>
            <%= b.check_box class: 'dn' %>
            <% end %>
            <%= content_tag :span, b.text %>
            <div class="checkmark fill-orange fr dn">
              <%= inline_svg 'check.svg' %>
            </div>
          <% end %>
        </li>
        <% end %>
        <li class="border-top border-bottom pas grey-1">
          <%= link_to 'Create New Collection...', collections_path(new_collection: true), class: 'link-reset' %>
        </li>
      </ul>
      <%= f.submit 'Save', class: 'btn bg-blue fr' %>
    <% end %>
  <% else %>
    <div class="text tc border rounded pal">
      You don't have any collections yet. Why don't you <%= link_to "create one", collections_path(:new_collection => true), class: "blue" %>?
    </div>
  <% end %>
</div>

<div id="shareModal" class="modal">
  <%= modal_close %>

  <h2>Share this recipe</h2>
  <hr>

  <div class="tab-container">

    <input type="radio" name="tab-set-2" class="tab-1" id="tab-2-1" checked>
    <label for="tab-2-1" class="rounded-top dib border bg-grey-5">Share a link</label>

    <input type="radio" name="tab-set-2" class="tab-2" id="tab-2-2">
    <label for="tab-2-2" class="rounded-top dib border bg-grey-5">Download a PDF</label>

    <input type="radio" name="tab-set-2" class="tab-3" id="tab-2-3">
    <label for="tab-2-3" class="rounded-top dib border bg-grey-5">Embed on the Web</label>

    <br>

    <div class="content content-1 pas border rounded-bottom">
      <% if @recipe.shared? %>
      <p>Your recipe is already shared!</p>
      <p><%= link_to 'Check out the share page', @shared_url, class: 'btn bg-blue' %></p>
      <% else %>
      <p>Anyone with this link can see your recipe and save a copy to their own Noodles account.</p>
      <p><%= link_to 'Share a link to this recipe', recipe_share_it_path(@recipe), class: 'btn bg-blue' %></p>
      <% end %>
    </div>

    <div class="content content-2 pas border rounded-bottom">
      <p>Click the button below to download a PDF of your recipe.</p>
      <p><%= link_to 'Download PDF', recipe_export_pdf_path(@recipe), class: 'btn bg-blue' %></p>
    </div>

    <div class="content content-3 pas border rounded-bottom">
      <p>Copy and paste the code below onto your website or blog to embed this recipe.</p>
      <pre class="man pas border rounded bg-grey-6" style="white-space: inherit;">
        <%= '<script src="https://getnoodl.es/embed/' + @recipe.shared_id.to_s + '"></script>' %>
      </pre>
      <p class="mts"><%= link_to 'Need help?', help_path %></p>
    </div>

  </div>

</div>

<a class="btn-paper-mini bg-orange fill-white circle fixed pas pointer shadow tooltipped"
   aria-label="Print this recipe" data-behavior="print">
  <%= inline_svg 'print.svg' %>
</a>

<%= link_to recipe_cook_path(recipe_id: @recipe.id),
            class: 'btn-paper bg-orange fill-white circle fixed pam shadow tooltipped',
            'aria-label': 'Open Cook Mode' do %>
  <%= inline_svg 'cook.svg' %>
<% end %>
