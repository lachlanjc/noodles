<%- title @recipe.title %>
<% activate_nav!(:shared_recipe) %>

<% content_for :meta do -%>
  <meta name="twitter:card" content="summary">
  <meta property="og:site_name" content="Noodles" />
  <meta name="twitter:domain" content="getnoodl.es">
  <meta property="og:url" content="<%= @shared_url %>">
  <meta property="og:title" content="<%= @recipe.title %>">
  <meta name="twitter:title" content="<%= @recipe.title %>">
  <% if @recipe.img.url == '' %>
    <meta property="og:image" content="<%= image_url('apple-touch-icon.png') %>"/>
    <meta name="twitter:image:src" content="<%= image_url('apple-touch-icon.png') %>">
  <% else %>
    <meta property="og:image" content="<%= @recipe.img.url %>"/>
    <meta name="twitter:image:src" content="<%= @recipe.img.url %>">
  <% end %>
  <% if @recipe.description == nil %>
    <meta property="og:description" content="<%= @recipe.title %> is a recipe published on Noodles, an app to help you cook better.">
    <meta property="twitter:description" content="<%= @recipe.title %> is a recipe published on Noodles, an app to help you cook better.">
  <% else %>
    <meta property="og:description" content="<%= @recipe.description %>">
    <meta name="twitter:description" content="<%= @recipe.description %>">
  <% end %>
<% end -%>

<%= render 'shared/nav' %>

<article class="col-7 recipe-print document">

  <h1 class="m0 ib"><%= @recipe.title %></h1>

  <p class="text-muted m1-btm">Shared by <%= User.find(@recipe.user_id).first_name %></p>
  <%= markdown(@recipe.description) %>

  <% if me_owns_recipe? %>
    <div class="panel ib social-panel">
      <h2>Great, your recipe is public!</h2>
      <%= render 'shared/social' %>
    </div>
  <% end %>

  <%= render 'recipe_body', cache: true %>

  <%# If it's your recipe, hint about saving %>
  <% if me_owns_recipe? %>
  <div class="m1-5-top print-hide">
    <a class="btn m1-right" title="Others can click this button to save a copy of your recipe to their Noodles account." disabled>Save</a>
    <%= link_to 'Un-share', recipe_un_share_path(@recipe), class: 'btn-red m1-right' %>
    <a class="btn-blue" id="printRecipe"><%= t('general.print') %></a>

  <%# If you're logged in, show Save button %>
  <% elsif user_signed_in? %>
  <div class="m1-5-top print-hide">
    <%= link_to 'Save', :save_to_noodles, title: 'Save a copy of this recipe to your own account', class: 'btn m1-right' %>
    <a class="btn-blue" id="printRecipe"><%= t('general.print') %></a>

  <%# Everyone else should sign up for Noodles %>
  <% else %>
  <div class="panel print-hide center col-8">
    <h2>Wondering about Noodles?</h2>
    <p><%= link_to 'Noodles', root_url, class: 'text-primary' %> is a simple app for you to collect, cook, and share your favorite recipes.
    <p><%= link_to 'Sign up', :sign_up, class: 'text-primary' %> to save this recipe &mdash; it's fast and completely free.</p>
    <p><%= link_to 'Try Noodles', :sign_up, class: 'btn' %>
  </div>
  <% end %>

  </div>

  <%= render 'shared/printer' %>

</article>
