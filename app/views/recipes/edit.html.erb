<% activate_nav!(:edit_recipe) %>

<style>
textarea {
  min-width: 32rem;
}

@media (max-width: 48em) {
  .home {
    display: inline-block;

    svg {
      margin-left: auto;
      margin-right: auto;
    }
  }
}
</style>

<%= link_to recipes_path, class: 'm2 home fixed' do %>
  <%= inline_svg 'home.svg', class: 'fill-grey-4', style: 'width: 32px; height: 32px;' %>
<% end %>

<main class="md-col-8 mx-auto p2">
<%= form_for(@recipe) do |f| %>

  <%= f.file_field :img, class: 'hide', data: { behavior: 'photo_field' } %>
  <div class="inline-block pointer" data-behavior="photo_button">
    <%= react_component 'IconPhoto', size: 32, classes: 'fill-grey-4' %>
    <span class="grey-4 up-10" data-behavior="photo_name">
  <% if @recipe.img.url.blank? %>
      Click to upload a photo</span>
    </div>
  <% else %>
      Upload a new photo</span>
    </div>
    <span class="grey-4 up-10">
      or <%= link_to 'remove current photo', recipe_remove_image_path(recipe_id: @recipe.id), class: 'link-reset' %>
    </span>
  <% end %>

  <% if @recipe.errors.any? %>
    <div class="bg-white rounded shadow mb2 p2">
      <h2>Oops! You need to title the recipe.</h2>
      <p>Click below and type a name for your recipe.</p>
    </div>
  <% end %>

  <%= f.text_field :title,
                   value: params[:title].present? ? params[:title].to_s.capitalize.strip : @recipe.title,
                   autofocus: true, required: true,
                   class: 'text-input invisible-input full-width m0 bold h1',
                   placeholder: 'Title your recipe...',
                   autocomplete: 'off' %>

  <%= f.text_area :description,
                  class: 'text-input invisible-input full-width',
                  placeholder: 'Optionally, write a description for the recipe right here.',
                  rows: '1',
                  autocomplete: 'off',
                  data: { behavior: 'autosize' } %>

  <%= f.label :ingredients, class: 'inline-block h3' %><small class="ml1 grey-4">Put one on each line.</small>
  <%= f.text_area :ingredients,
                  class: 'text-input invisible-input full-width m0',
                  placeholder: 'Click here to add your recipe\'s ingredients.',
                  rows: '3',
                  autocomplete: 'off',
                  data: { behavior: 'autosize' } %>

  <%= f.label :instructions, class: 'inline-block h3' %><small class="ml1 grey-4">Fully supports Markdown.</small>
  <%= f.text_area :instructions,
                  class: 'text-input invisible-input full-width m0',
                  placeholder: 'Type the recipe\'s instructions here.',
                  rows: '4',
                  autocomplete: 'off',
                  data: { behavior: 'autosize editor_instructions' } %>

  <section>
    <h2 class='mt0'>Details</h2>

    <%= f.label :source, class: 'inline-block' %><small class="ml1 grey-4">Where did this recipe come from?</small>
    <%= f.text_field :source, class: 'text-input md-col-8' %>

    <%= f.label :author, class: 'inline-block' %><small class="ml1 grey-4">Who originally wrote this recipe?</small>
    <%= f.text_field :author, class: 'text-input md-col-8' %>

    <%= f.label :serves, 'Yield', class: 'inline-block' %><small class="ml1 grey-4">How many servings does your recipe produce?</small>
    <%= f.text_field :serves, class: 'text-input md-col-8' %>
  </section>

  <%= f.submit t('general.save'), class: 'btn bg-grey-4 mt3 mb3', data: { disable_with: 'Saving...' } %>

<% end %>
</main>

<%= javascript_include_tag "editor" %>
